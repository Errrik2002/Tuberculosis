# Mendoza Velazquez Mayra Beatriz / Genomica funcional
# Utilizamos la primera base pero nos dimos cuenta que los primeros genes investigados
# no sirven de mucho en el proceso de categorizacion de funciones que desempeñan los 
# genes en el proces de progresion de cancer. Intentaremos con nuevas bases. 

# ID: GSE67522 
# TITULO DEL ESTUDIO: Genome-wide analysis of gene expression to identify the probably 
# functionally relevant pathways in cervical cancer progression
#######################################################################################
# comenzamos con el analisis (vamos a sacar sobre y subexpresados y de ahi partiremos
# para analizar los roles que van a desempeñar dichos genes en progresion de cancer)

vph16_ed122 <-read.csv("01_RawData/GSE67522_HPV16vsControl.tsv",dec=",",sep="\t")
View(vph16_ed122)
# El primer paso es cargar la base de datos, que ya se encuentra descargada en la carpeta
# de 01_Raw_Data
# Que obtenemos: Obtenemos un data frame con toda la infomracion sobre las mueustras obtenidas
# Esta base esta bastante buena porque nos indica no solo el id del gen sino tambien su nombre
# (tanto nombre completo como la forma de identificacion rapida)


gensubxp <- subset(vph16_ed122, vph16_ed122$logFC < 0 | vph16_ed122$P.Value < 0.05)
View(gensubxp)

# El siguiente paso es determinar genes sobre y subexpresados dentro de la muestra 
# para eso realizo un subset, donde de la base original le digo a R que seleccione aquellos genes
# que tienen un valor de logFC menor a 0 y ademas presenten un valor de p asociado menor a 0.05 
# que es el valor umbral sobre el cual trabajamos 
# Que obtenemos: Obtenemos la misma tabla, con la isma estructura, la diferencia ahora es que solo 
# tenemos aquellos genes subexpresados dentro de la muestra 


orn1 <- gensubxp[order(gensubxp$logFC, decreasing = TRUE),]
View(orn1)

# El siguiente paso es ordenar los renglones(es decir, los genes que cumplen tanto con el valor de 
# logFC como el valor de p.value) en base al log fold change 
# Para eso utilizo la funcion order
# funcion order: me ayuda a ordenar en base a la columna que yo desee, puede ser en base a 2 
# pero como ya seleccione los valores que son significativos de p solo selecciono en base al 
# logFC

# genes menos expresados: 
menosxp <- orn1[1:10,]
menosxp


### GENES SOBRE-EXPRESADOS ###
# Repito exactamente los mismos pasos pero para los genes sobre expresados 
gensobx <- subset(vph16_ed122, vph16_ed122$logFC > 0 | vph16_ed122$P.Value < 0.05)
View(gensobx)

# Vuelvo a pedir a R que seleccione valores de las dos columnas de interes, en este 
# caso lo que cambia son los valores, le pido que seleccione valores mayores a 0 en 
# logFC y valores menores a 0.05 (esto se queda igual porque es el valor umbral para
# determinar que es significativo)

orn2 <- gensobx[order(gensobx$logFC, decreasing = T),]
View(orn2)

# Repetimos el paso anterior y asi obtenemos una base de datos ordenada con los genes
# que nos interesan, siendo los que estan al inciio aquellos mayormente expresados 
# ahora lo que sigue es seccionar dicha base obteniendo solo los 10 que nos interesan 
# mas que son los primeros 

# genes mas expresados: 
sobre <- orn2[1:10,]
sobre

# El siguiente paso es determinar las funciones que cada uno de ellos desempeña en la progresion
# de cancer, para ello utilizamos informacion en articulos consultados. 
